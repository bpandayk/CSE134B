function accInfo(){var b=(parser.providerId,parser.photoURL),c=' <div class = "movdetail" >';c=username?c+"<div><h2>Hello "+username+"!</h2></div>":c+"<div><h2>Hello "+email+"!</h2></div>",c=c+'<div class="second-level"> <div class="col1"><img src='+b+' style="width:200px; height:200px;"></div> <div class="col2">',username&&(c=c+' <div class="name"> <span>'+username+"</span></div>"),c=c+' <div class="desc"> <span> Memeber since 2017 </span></div><div class="desc"> <span> Email: '+email+' </span></div><div class="desc"> <span> <a href="javascript:void(0);" onclick="resetPassword()" > Reset Password </a></div><div class="desc2"><span id="confirm" style="color:red;"></span><div> </div> </div>',document.getElementById("sub-contain").innerHTML=c}function resetPassword(){firebase.auth().sendPasswordResetEmail(email).then(function(){document.getElementById("confirm").innerHTML="Email has been sent to "+email+" to reset the Password."},function(a){})}function mybodyLoad(){username?document.getElementById("menu").innerHTML="Hi "+username:document.getElementById("menu").innerHTML="Hi "+em[0];var a=localStorage.getItem("current");if("addMovie"==a)addMovieDom();else if("myMovie"!=a&&a)if("viewdetail"==a){var b=localStorage.getItem("detail");showDetail(b)}else myMovieDom();else myMovieDom()}function getFormValues(){moviename=document.getElementById("mname").value,date=document.getElementById("movdate").value,genre=document.getElementById("Genre").value,rating=document.getElementById("rrate").value,enjoyed=document.getElementById("enjoy").value,description=document.getElementById("desc1").value,uploader=document.getElementById("movimg").files}function addMovieDom(){document.getElementById("sub-contain").innerHTML=addMovieD,"undefined"!=typeof Storage&&localStorage.setItem("current","addMovie")}function myMovieDom(){document.getElementById("sub-contain").innerHTML=myMovie,getData("Action","Act"),getData("Comedy","Com"),getData("Family&kids","F&K"),getData("Drama","Dma"),getData("Horror&scifi","H&S"),getData("Documentries","Doc"),"undefined"!=typeof Storage&&localStorage.setItem("current","myMovie")}function validateForm(){var a=!0;return getFormValues(),moviename?document.getElementById("l1").style.color="white":(document.getElementById("l1").style.color="red",a=!1),date?document.getElementById("l2").style.color="white":(document.getElementById("l2").style.color="red",a=!1),"None"==genre?(document.getElementById("l3").style.color="red",a=!1):document.getElementById("l3").style.color="white","0"==rating?(document.getElementById("l4").style.color="red",a=!1):document.getElementById("l4").style.color="white","None"==enjoyed?(document.getElementById("l5").style.color="red",a=!1):document.getElementById("l5").style.color="white",description?document.getElementById("l6").style.color="white":(document.getElementById("l6").style.color="red",a=!1),0==uploader.length?(document.getElementById("l7").style.color="red",a=!1):document.getElementById("l7").style.color="white",a}function getData(a,b){var d,c="/users/"+UID+"/"+a;return firebase.database().ref(c).once("value").then(function(c){d=c.val();var f,g,h,i,j,k,l,m,e=" ";if(d){var n=Object.keys(d);for(var o in n){f=n[o],g=d[n[o]].m_name,k=d[n[o]].m_date,i=d[n[o]].m_rating,j=d[n[o]].m_enjoy,h=d[n[o]].m_genre,l=d[n[o]].m_desc,m=d[n[o]].m_url;var p='<div class="viewimg"> <img src='+m+" onclick=\"showDetail('"+f+"%"+a+'\')" class="mainimg"> </div>';e+=p}}document.getElementById(b).innerHTML=e})}function showDetail(a){console.log(a);var h=a.split("%"),i="/users/"+UID+"/"+h[1]+"/"+h[0];return firebase.database().ref(i).once("value").then(function(b){ret=b.val();var d,e,f,g,h,i,j;ret&&(d=ret.m_name,h=ret.m_date,f=ret.m_rating,g=ret.m_enjoy,e=ret.m_genre,i=ret.m_desc,j=ret.m_url);var k=' <div class = "movdetail" ><div><h2>'+d+'</h2></div><div class="second-level"><div class="col1"><img src='+j+' class="detailimg"><div class="rating"><span id="star0">☆</span><span id="star1">☆</span><span id="star2">☆</span><span id="star3">☆</span><span id="star4">☆</span></div></div><div class="col2" id="updatedom"> <div class="name"> <span> '+d+' </span></div><div class= "desc"> <p id="desc123">'+i+' </p>  </div><div class= "genre1"> <span> Genre </span> <span class="gen2">'+e+' </span> </div><div class= "refer"> <span> Enjoyed </span> <span class="gen2">'+g+' </span> </div><div class= "date"> <span> Watched on </span> <span class="gen2">'+h+' </span> </div></div></div><div class="addsub"><input type="button" id="update" value="Update" onclick="updateData(\''+a+'\')"></div><div class="addsub"><input type="button" id = "del" value="Delete" onclick="deleteData(\''+a+"')\"></div></div>";document.getElementById("sub-contain").innerHTML=k,"undefined"!=typeof Storage&&(localStorage.setItem("current","viewdetail"),localStorage.setItem("detail",a)),1==f&&(document.getElementById("star0").style.color="gold",document.getElementById("star1").style.color="white",document.getElementById("star2").style.color="white",document.getElementById("star3").style.color="white",document.getElementById("star4").style.color="white"),2==f&&(document.getElementById("star0").style.color="gold",document.getElementById("star1").style.color="gold",document.getElementById("star2").style.color="white",document.getElementById("star3").style.color="white",document.getElementById("star4").style.color="white"),3==f&&(document.getElementById("star0").style.color="gold",document.getElementById("star1").style.color="gold",document.getElementById("star2").style.color="gold",document.getElementById("star3").style.color="white",document.getElementById("star4").style.color="white"),4==f&&(document.getElementById("star0").style.color="gold",document.getElementById("star1").style.color="gold",document.getElementById("star2").style.color="gold",document.getElementById("star3").style.color="gold",document.getElementById("star4").style.color="white"),5==f&&(document.getElementById("star0").style.color="gold",document.getElementById("star1").style.color="gold",document.getElementById("star2").style.color="gold",document.getElementById("star3").style.color="gold",document.getElementById("star4").style.color="gold")})}function submitData(){var a=validateForm(),b=moviename.split(" ").join("");moviename=moviename.toUpperCase();var c;if(a){if(uploader){var d=firebase.storage().ref("images/"+b);d.put(uploader[0]).then(function(a){console.log(a.downloadURL),c=a.downloadURL,"Action"==genre&&(path="users/"+UID+"/Action"),"Comedy"==genre&&(path="users/"+UID+"/Comedy"),"Drama"==genre&&(path="users/"+UID+"/Drama"),"Family&Kids"==genre&&(path="users/"+UID+"/Family&kids"),"Horror&Scifi"==genre&&(path="users/"+UID+"/Horror&scifi"),"Documentries"==genre&&(path="users/"+UID+"/Documentries");var d=path+"/"+b;return console.log(d),firebase.database().ref(d).set({m_name:moviename,m_date:date,m_genre:genre,m_rating:rating,m_enjoy:enjoyed,m_desc:description,m_url:c})}).then(function(a){console.log("data added"),myMovieDom()})}console.log("success")}}function deleteData(a){var b=a.split("%"),c="/users/"+UID+"/"+b[1]+"/"+b[0];return console.log(b[0]),firebase.database().ref(c).remove().then(function(a){console.log("success on delete");var c=firebase.storage().ref("images/"+b[0]);c.delete().then(function(){console.log("file deleted"),myMovieDom()})}).catch(function(a){console.log(a)})}function updateData(a){var h=a.split("%"),i="/users/"+UID+"/"+h[1]+"/"+h[0];return firebase.database().ref(i).once("value").then(function(b){ret=b.val();var d,e,f,g,h,i,j;ret&&(d=ret.m_name,h=ret.m_date,f=ret.m_rating,g=ret.m_enjoy,e=ret.m_genre,i=ret.m_desc,j=ret.m_url);var k=' <div> <form> <div class="name" id="spname"> <span> '+d+' </span></div> <div class="name" id="spname2"> <span> Genre: &nbsp&nbsp'+e+' </span></div><label for="date1" id="l2">When did you watch this movie?</label><input type="date" name="wday" id="movdate" style="color:black;"> <label for="rate" id="l4">Rating</label><select id="rrate" name="Rate" style="color:black;"><option value="0" selected></option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select><label for="enjoy" id="l5">Did you Enjoy the movie?</label><select id="enjoy" name="enjoy" style="color:black;"><option value="None"></option><option value="yes">Yes</option><option value="no">No</option></select><label for="desc" id="l6">Movie Description</label><textarea rows="8"  id="desc1" style="color:black;"> </textarea><label for="movimg" id="l7">Movie Image </br></label><input type="file" id="movimg" name="movimage" accept=".jpg,.jpeg,.png"><div class="addsub"><input type="button" value="Submit" onclick="submitupdateData(\''+a+"')\"></div></form></div>";document.getElementById("updatedom").innerHTML=k,document.getElementById("update").remove(),document.getElementById("del").remove()})}function submitupdateData(a){var b=a.split("%"),c="/users/"+UID+"/"+b[1]+"/"+b[0]+"/";if(date=document.getElementById("movdate").value,rating=document.getElementById("rrate").value,enjoyed=document.getElementById("enjoy").value,description=document.getElementById("desc1").value,uploader=document.getElementById("movimg").files,console.log(uploader),0==uploader.length){var e={};return date&&(e[c+"m_date"]=date),"0"!==rating&&(e[c+"m_rating"]=rating),"None"!==enjoyed&&(e[c+"m_enjoy"]=enjoyed)," "!==description&&(e[c+"m_desc"]=description),firebase.database().ref().update(e).then(function(b){console.log(b),showDetail(a)},function(a){console.log(a)})}var d=firebase.storage().ref("images/"+b[0]);d.delete(),d.put(uploader[0]).then(function(b){console.log(b.downloadURL),downloadURL=b.downloadURL;var d={};return date&&(d[c+"m_date"]=date),"0"!==rating&&(d[c+"m_rating"]=rating),"None"!==enjoyed&&(d[c+"m_enjoy"]=enjoyed)," "!==description&&(d[c+"m_desc"]=description),d[c+"m_url"]=downloadURL,firebase.database().ref().update(d).then(function(b){console.log(b),showDetail(a)},function(a){console.log(a)})})}function searchDom(){var a=document.getElementById("srch").value,b="/users/"+UID;if(a)return a=a.toUpperCase(),firebase.database().ref(b).once("value").then(function(b){var c=[],d=b.val(),e=Object.keys(d),f=" ";for(i in e){var g=Object.keys(d[e[i]]);for(j in g)d[e[i]][g[j]].m_name==a&&(c.push(d[e[i]][g[j]]),f+='<div> <img class="mainimg" src='+c[0].m_url+" onclick=\"showDetail('"+g[j]+"%"+d[e[i]][g[j]].m_genre+"')\"> </div>")}if(0==c.length){var h='<div style="padding-top: 20px; color:red; font-size:25px; "><span > Sorry !'+a+" could not be found. Please click Add movies to add.";document.getElementById("sub-contain").innerHTML=h}else document.getElementById("sub-contain").innerHTML=f})}function logout(){firebase.auth().signOut().then(function(){"undefined"!=typeof Storage&&(localStorage.setItem("current",void 0),window.location.href="index.html",console.log("logged out succesfully!"))},function(a){console.log(a)})}var moviename,date,genre,rating,enjoyed,description,myMovie=!1,addMovie=!1,search=!1,uploader,myMovie='<div class = "titles"><h3 class="act"><span class = "genre"> Action </span></h3><div class = "action" id="Act"></div><div class = "titles"><h3><span class = "genre"> Comedy </span></h3></div><div class = "comedy" id="Com"></div><div class = "titles"><h3><span class = "genre"> Drama </span></h3></div><div class = "drama" id="Dma"></div><div class = "titles"><h3><span class = "genre"> Family and Kids </span></h3></div><div class = "family-kids" id="F&K"></div> <div class = "titles"><h3><span class = "genre"> Horror and Scifi </span></h3></div><div class = "horror-scifi" id="H&S"></div> <div class = "titles" ><h3><span class = "genre"> Documentries </span></h3></div><div class = "documentries"  id="Doc"></div> </div>',searchMovie,addMovieD=' <div class=" second-level" id="secondlvl"><div class="col21"> <div> <form class="form-horizontal" id = "addmov1"><label for="mname" id="l1">Movie Name</label><input type="text" id="mname" name="moviename" placeholder="Latest movie you watched ..." style="color:black;"><label for="date1" id="l2">Movie watched on</label><input type="date" name="wday" id="movdate" style="color:black;"><label for="genre" id="l3">Genre</label><select id="Genre" name="Genre" style="color:black;"><option value="None" selected></option><option value="Action">Action</option><option value="Comedy">Comedy</option><option value="Drama">Drama</option><option value="Family&Kids">Family & Kids</option><option value="Horror&Scifi">Horror & Scifi</option><option value="Documentries">Documentries</option></select> <label for="rate" id="l4">Rating</label><select id="rrate" name="Rate" style="color:black;"><option value="0" selected></option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select><label for="enjoy" id="l5">Did you Enjoy the movie?</label><select id="enjoy" name="enjoy" style="color:black;"><option value="None"></option><option value="yes">Yes</option><option value="no">No</option></select><label for="desc" id="l6">Movie Description</label><textarea rows="8"  id="desc1" style="color:black;"> </textarea><label for="movimg" id="l7">Movie Image </br></label><input type="file" id="movimg" name="movimage" accept=".jpg,.jpeg,.png"><div class="addsub"><input type="button" value="Submit" onclick="submitData()"></div></form></div></div></div>',config={apiKey:"AIzaSyAupx69r_nEJqhkmzUAelKgZhPoguFrbXY",authDomain:"cse134b-team-alpha.firebaseapp.com",databaseURL:"https://cse134b-team-alpha.firebaseio.com",storageBucket:"cse134b-team-alpha.appspot.com",messagingSenderId:"730498444325"};firebase.initializeApp(config);var database=firebase.database(),storage=firebase.storage(),user=localStorage.getItem("firebase:authUser:AIzaSyAupx69r_nEJqhkmzUAelKgZhPoguFrbXY:[DEFAULT]"),parser=JSON.parse(user),UID=parser.uid,username=parser.displayName,em,email=parser.email;username?username=username.toUpperCase():em=email.split("@"),console.log(parser);